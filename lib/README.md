# Assignment 1 - API testing and Source Control.

Name: Lu Sun            
Student Num: w20082256

## Overview.
This assessment is about a Cargo Delivery System, \
including two models: cargo and provider;\
with relationship between them: `Cargo.providerID` linked to `provider.ObjectID`;\
(the relevance search function will use this relationship in my project)\
containing some complex functions like `Fuzzy search`, `relevance search`,\
and some of the function has Authentication:\
(Only those whose `providerType` is "`admin`" can do some of the function,\
 otherwise it will return a message of authentication not enough);

## API endpoints.
    1.1    get/cargoAll/:providerName		only those provider whose providerType is "admin" can get all cargos; otherwise return a massage of authentication not enough	(Authentication);
 
 	1.2    get/cargoCompany/:id			 (Relevance search), company and reputation are two attributes of provider  (NOT Cargo model !!) but by link these two models, we can search a certain cargo's company and its ruputation; (see that the database)
 
 	1.3    get/cargoContains/:name/:providerName	 (Authentication, Fuzzy search)    if the provider's providerType is "admin" can search;  this function returns all the cargos which contains :name(like i search beef, it can return me beef, beef-tongue, beef-fillet, etc.)
 
 	1.4    get/cargoName/:name/providerName	         (Authentication)	admin can search all cargos whose name is you asked;  others cant do;
 
 	1.5    get/cargoId/:id/:providerName		 (Authentication)	admin can search a certain cargo by its ID, or the provider of that cargo can search his own one by himself;
 
 	1.6    get/cargoTotalCostByName/:name	                                compute the total price of one kind of cargo;
 	1.7    get/cargoCertainCost/:id		                                compute a certain cargo's price by its ID;
 
 	1.8    post/cargo/:providerName		         (Authentication)	          admin can add a cargo;
 	
 	1.9    put/cargoPriceChange/:name/:providerName	   (Authentication)	admin can change all one kind of cargo's price;
 	1.10  put/cargoCertainPrice/:id/:providerName      (Authentication)	admin can change one certain cargo's price by ID
 
 	1.11  put/cargoCertainAmount/:id/:providerName		(Authentication)	admin can change one certain cargo's amount by its ID
 	
 	1.12  put/cargoCertainProvider/:id/:providerName	(Authenticaiton)	admin can change one certain cargo's provider; 
 
 	1.13  delete/cargo/:id/:providerName		(Authentication)	admin can delete one certain cargo by its ID

## Data storage.
For my cargo model, each cargo contains several attributes:\
cargo model: `_id`, `name`, `price`,`amount`,`providerName`,`providerType`,\
`providerID(foreign key,linked to provider._id)`;\
provider model:`name`,`cargoProvide`,`company`,`providerReputation`,\
`ObjectID(automated generated by mongo)`


## Sample Test execution.
. Here is the true copy of my running test result:

        $ mocha test/cargo-test
          
          
          (node:8868) DeprecationWarning: current URL string parser is deprecated, and will be removed in a future version. To use the new parser, pass option { useNewUrlParser: true } to MongoClient.connect.
            cargo
              GET /cargoAll/John
          Successfully Connected to [ Cargo ]
          Successfully Connected to [ Cargo ]
          Successfully Connected to [ Cargo ]
          GET /cargoAll/John 200 1006.467 ms - 2330
                √ should return all the cargo if has authentication (1038ms)
          GET /cargoAll/Sam 200 2.085 ms - 56
                √ should return massage of authentication not enough
          GET /cargoAll/aaa 200 1.249 ms - 22
                √ should return massage of wrong provider name
          double callback!
              GET /cargoName
          [ { _id: 5bc908e35a6760bc51a7f9ab,
              name: 'beef',
              price: 500,
              amount: 44,
              providerID: 5bc9066a5a6760bc51a7f9a2,
              providerName: 'Sam',
              providerType: 'user' },
            { _id: 5bc9098c5a6760bc51a7f9ae,
              name: 'beef',
              price: 500,
              amount: 300,
              providerID: 5bc906bb5a6760bc51a7f9a5,
              providerName: 'Bob',
              providerType: 'user' } ]
          GET /cargoName/beef/John 200 10.315 ms - 509
                √ should return all one kind of cargos if has authentication
          GET /cargoName/beef/Sam 200 2.980 ms - 47
                √ should return massage of authentication
          GET /cargoName/aaa/John 200 5.340 ms - 20
                √ should return massage of invalid name
          double callback!
          GET /cargoName/beef/aaa 200 1.184 ms - 23
                √ should return massage of wrong provider name
              GET /cargoContains/:name/:providerName
          GET /cargoContains/beef/John 200 1006.580 ms - 769
                √ should return all cargo contain certain names if has authentication (1012ms)
          GET /cargoContains/beef/Sam 200 1.821 ms - 47
                √ should return massage of authentication not enough
          GET /cargoContains/beef/aaa 200 2.009 ms - 23
                √ should return massage of wrong provider name
          double callback!
              GET /cargoCompany/:id
          GET /cargoCompany/:id 200 1.986 ms - 48
                √ should return certain cargo company and its reputation
          GET /cargoCompany/asdfa 200 0.914 ms - 48
                √ should return massage of invalid id
              GET /cargoTotalCostByName/:name
          GET /cargoTotalCostByName/chicken 200 2.608 ms - 19
                √ should return one kind of cargo total cost if invalid name
          GET /cargoTotalCostByName/asdfa 200 1.123 ms - 15
                √ should return massage of invalid name
              GET /cargoCertainCost/:id
          GET /cargoCertainCost/5bc908665a6760bc51a7f9a9 200 1.817 ms - 20
                √ should return a certain cargo cost of invalid id
          GET /cargoCertainCost/asdasf 200 0.717 ms - 20
                √ should return massage of invalid name
              POST /cargo/John
          POST /cargo/John 200 14.716 ms - 54
                √ should return cargo not successfully added because missing properties
          POST /cargo/Sam 200 2.215 ms - 56
                √ should return massage of authentication not enough
          GET /cargoAll/John 200 3.391 ms - 2330
              DELETE /cargo/:id
          DELETE /cargo/5bc907cd5a6760bc51a7f9a8/John 200 6.369 ms - 41
                √ should return a message of Donation Successfully Deleted
          DELETE /cargo/adfasdf/John 200 1.573 ms - 49
                √ should return a message of invalid id
          DELETE /cargo/5bc907cd5a6760bc51a7f9a8/Sam 200 1.454 ms - 58
                √ should return massage of authentication
          GET /cargoAll/John 200 4.252 ms - 2330
              PUT /cargoCertainPrice/:id/providerName
          PUT /cargoCertainPrice/5bc907cd5a6760bc51a7f9a8/John 200 5.270 ms - 49
                √ should return a message and the cargo price successfully changed
          PUT /cargoCertainPrice/12345/John 200 1.941 ms - 41
                √ should return a message for invalid cargo id
          PUT /cargoCertainPrice/5bc907cd5a6760bc51a7f9a8/Sam 200 1.467 ms - 58
                √ should return massage of authentication not enough
              PUT /cargoPriceChange/:id/providerName
          PUT /cargoPriceChange/beef/John 200 2.849 ms - 49
                √ should return a message and the cargo price successfully changed
          PUT /cargoPriceChange/basdf/John 200 2.673 ms - 49
                √ should return a message for invalid cargo id
          PUT /cargoPriceChange/beef/Sam 200 1.442 ms - 58
                √ should return massage of authentication not enough
              PUT /cargoCertainAmount/:id/providerName
          PUT /cargoCertainAmount/5bc907cd5a6760bc51a7f9a8/John 200 2.483 ms - 49
                √ should return a message and the cargo price successfully changed
          PUT /cargoCertainAmount/12345/John 200 1.976 ms - 42
                √ should return message for invalid cargo id
          
          
            29 passing (2s)

        $



## Extra features.
some reference of my functions:\
1. for that relevance search: 
		https://segmentfault.com/a/1190000009690117

2. for the fuzzy search: (searched mongo API and find its fuzzy search function by `regular expression`):		
		mongoose  API:\
		         https://mongoosejs.com/docs/api.html 
		
	mongoDB  Api:\
		  http://mongodb.github.io/node-mongodb-native/2.0/api/Collection.html#find

